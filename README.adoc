:experimental:
:imagesdir: Images/
ifdef::env-github[]
:icons:
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]

== About

TuneUp11 was created out of disdain for custom Windows ISOs and the various different optimizing scripts breaking programs I used. +
I also thought other optimizers were too complex for what they did, and had a hellish amount of lines of code.

NOTE: *Known alternatives:* O&O ShutUp10, W10Privacy, BloatyNosy, Wintoys, ChrisTitusTech's winutil, Pointstone AntiTrack, Debotnet, Debloat Windows 10, Atlas OS, Spybot Anti-Beacon, and Winrice.

- What TuneUp11 by default specializes in:
** No breaking programs or apps.
** Increases security instead of compromising on it.
** Increased privacy and consistency of game or real-time program performance.
** Fully open-source.
*** Exceptions: 'https://www.virustotal.com/gui/file/f4a33deebc499ae70e479ba75b6161cae9e1626d852af7a40b96c7d69207e607?nocache=1[PolFileEditor.dll]' and 'https://www.virustotal.com/gui/file/3d5b4d790ffe6d8f0c16b4ddc4dc1b1ed93388c1cb1526083ad2d367309d805f[SetTimerResolution.exe]'.

** Changes are tunneled through the Group Policy Editor, therefore:
*** Windows Update does not revert TuneUp11's changes.
*** TuneUp11's changes can be viewed from a graphical interface via `rsop.msc`. +
image:RSOP.png[]


== The catches
. Windows Home editions are not supported; see https://github.com/Fleex255/PolicyPlus#special-considerations-for-use-on-home-editions[this excerpt] from PolicyPlus on why.

. Microsoft Edge is assumed to not be the default browser; it will not automatically update (auto-updates still work if Edge is open).

. Memory/RAM usage will be higher to reduce: CPU usage and potential hitches/stuttering in video playback and games.

. You have to do the following manually:
- Set a relevant compatibility mode for old programs requiring say, Windows XP mode.
- Clear thumbnail cache if it ever corrupts.


== Instructions

* Check if the Windows Package Manager is functional by running `winget` in PowerShell.

.Fixing `winget` if it doesn't work.
[%collapsible]
====
* For Windows 11, open the Microsoft Store, then update "App Installer" through it.

* For Windows 10 LTSC 2019/2021, run in Command Prompt as Administrator to install `winget`:
** `wsreset -i`
** If the Microsoft store doesn't show up after this command is complete, reboot.
** Open the Microsoft Store, then install "App Installer" through it.

====

. Download the https://github.com/felikcat/TuneUp11/releases[latest TuneUp11] and extract it.

. Run `TuneUp11_Launcher.bat` as Administrator.

. Reboot after TuneUp11 is finished to see its changes in action.

== Extras
TIP: Login to the Microsoft Store before using `Install_Xbox_Minimal.bat`, otherwise it will not work. +
To also get the Game Bar, install the following link://www.microsoft.com/store/productId/9NZKPSTSNW4P[here] then link://www.microsoft.com/store/productId/9NBLGGH537C2[here].

* `Install_Xbox_Minimal.bat`
- Installs only what's required to support Xbox Controllers (GUI/interface not included, get it link://www.microsoft.com/store/productId/9NBLGGH30XJ3[here]), Microsoft's PC Game Pass, and specific games such as Forza Horizon 4 & 5.


* `Advanced.ps1`
** Contains a lot of extra features for those that know what they're doing.

** How to use:
- Disable any third-party firewalls such as Simplewall.
- Open `Advanced.ps1` in a text editor or IDE of your choosing to configure its options.
- Run `Advanced.ps1` as Administrator.


== Recommendations

=== BIOS
* *Enable the following:*
. I/O APIC (IOAPIC 24-119 Entries)
. Above 4G Decoding and Resizable BAR.
** On ASRock motherboards: C.A.M. (Clever Access Memory)
** This is incompatible with Windows installed on an MBR partition; if Windows can no longer boot, this setting caused it.
. HPET (High Precision Event Timer)

* *Disable the following:*
. XHCI Hands Off
. USB Legacy
** link://techcommunity.microsoft.com/t5/microsoft-usb-blog/reasons-to-avoid-companion-controllers/ba-p/270710[Why disable these two?] +
Note: if a USB is no longer bootable after these two changes, temporarily turn them both back on.


=== Windows

. Windows Settings:
- -> Gaming -> Enable `Game Mode`
- -> Graphics -> Change default graphics settings -> Enable `Hardware-accelerated GPU scheduling`, and `Optimizations for windowed games`.

. Auto-detect and install link://www.amd.com/en/support[AMD drivers]. +
Auto-detect and install link://www.intel.com/content/www/us/en/support/detect.html[Intel's drivers].
* This will utilize their drivers instead of the generic drivers Microsoft provides, meaning better performance and lower DPC latency.

. Install all optional updates through Windows Update; it can include device drivers.

. Remove every program you installed and work your way up to see what programs you really need.
- Use what Windows already includes instead of third-party programs. Keep it simple to reduce being impacted by https://www.bleepingcomputer.com/news/security/hackers-compromise-3cx-desktop-app-in-a-supply-chain-attack/[supply chain attacks] and to prevent causing Windows additional issues.

. Check if there's enterprise versions of manufacturer software, such as replacing Lenovo Vantage with Lenovo Commercial Vantage.


== Appendices

.Developer notes
[%collapsible]
====

* Required software:
. `winget install Microsoft.WindowsADK -eh`
. `scoop install git; scoop bucket add sysinternals; scoop install procmon`

__

* `reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\EXAMPLE" /v "Start" /t REG_DWORD /d 4 /f` is preferred over using `sc.exe config EXAMPLE start=disabled` since Windows rejects this request depending on the service.

* Non-volatile registry keys usually do not self-regenerate themselves if their key doesn't exist.
** If the purpose is to revert back to defaults, manually set the default value instead.

* The registry changes Group Policy edits do can be traced with link://docs.microsoft.com/en-us/sysinternals/downloads/procmon[Sysinternals Process Monitor].
** Filter to the process containing gpedit.msc: +
image:Procmon64_1.png[]
** Filter to registry changes only: +
image:Procmon64_2.png[]
*** Translate the traced registry edits to their non-group policy places, and there's your registry key edit.
**** Other processes of interest: +
`SystemPropertiesPerformance.exe`, `SystemSettings.exe`, `DllHost.exe` +
`SecurityHealthService.exe`

TIP: Example gpedit.msc registry translation: +
`HKCU\Software\Microsoft\Windows\CurrentVersion\Group Policy Objects\{2F5A9005-4CB6-4314-B846-8C3EB66C9C24}Machine\Software\Policies\Microsoft\Windows` *->* `HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent`

* Drivers currently loaded by Windows can be seen with link:https://systeminformer.sourceforge.io/downloads.php[System Informer] via:
. The "System" process -> Properties (right-click or press Enter with "System" selected) -> Modules

* List all from "Turn Windows features on or off" and their status:
. `(Get-WindowsOptionalFeature -Online -FeatureName '*') | Format-Table -Autosize`
- List all from "Settings > Apps > Optional features"/"Add an optional feature":
. `(Get-WindowsCapability -Online -Name '*') | Format-Table -Autosize`

====

.Learning material used
[%collapsible]
====

. link://archive.org/details/windows-internals-part1-7th/mode/2up[Windows Internals, Part 1, 7th Edition]
** link://github.com/zodiacon/WindowsInternals[Windows Internals, Part 1, 7th Edition (unofficial) Tools]

. link://www.microsoftpressstore.com/store/windows-internals-part-2-9780135462409[Windows Internals, Part 2, 7th Edition]
** This can be viewed for free from the link://en.wikipedia.org/wiki/Z-Library[Z-Library].

. link://github.com/MicrosoftDocs/windows-driver-docs/tree/staging/windows-driver-docs-pr[Windows Driver Documentation]

. link://therealmjp.github.io/posts/breaking-down-barriers-part-1-whats-a-barrier/[TheRealMJP's blog posts on how GPU synchronization and preemption work]

. link:https://bromiley.medium.com/windows-wednesday-shim-cache-1997ba8b13e7[Matt B's blog post on Application Compatibility Cache]


---

* These projects helped TuneUp11 improve at a more rapid pace:
. https://github.com/Atlas-OS/Atlas
. https://github.com/beatcracker/toptout
. https://github.com/M2Team/NSudo
====
