:experimental:
:imagesdir: Images/
ifdef::env-github[]
:icons:
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]

== About

.Roughly a back-story
[%collapsible]
====
TuneUp11 was originally created out of disdain for broken programs & apps as a result of custom Windows ISOs and various different optimizing scripts I tried.

I also used to make custom Windows 7 and 10 ISOs in the paid version of NTLite, an approach prone to breaking something in a way that isn't noticed until it's suddenly important. TuneUp11 is a seemingly dependable response to many of my prior failures over the years to have a fully stable Windows with what I perceived as removing its junk.

====

NOTE: *Known alternatives:* O&O ShutUp10, W10Privacy, BloatyNosy, Wintoys, ChrisTitusTech's winutil, Pointstone AntiTrack, Debotnet, Debloat Windows 10, Atlas OS, Spybot Anti-Beacon, and Winrice.

- What TuneUp11 specializes in:
** No breaking programs or apps.
** Increased privacy and consistency of game or real-time program performance.
** Increases security instead of compromising on it.
** TuneUp11 and a third-party script it pulls in (https://github.com/beatcracker/toptout[toptout]) is fully open-source.
*** Closed-source exceptions: 'https://www.virustotal.com/gui/file/f4a33deebc499ae70e479ba75b6161cae9e1626d852af7a40b96c7d69207e607?nocache=1[PolFileEditor.dll]'.

** Changes are tunneled through the Group Policy Editor, therefore:
*** Windows Update does not revert TuneUp11's changes.
*** TuneUp11's changes can be viewed from a graphical interface via `rsop.msc`. +
image:RSOP.png[]
*** TuneUp11 can *mostly* be reverted/uninstalled with two commands:
. `Remove-Item -Path "$env:windir\System32\GroupPolicy" -Recurse`
. `gpupdate.exe /force`


== Instructions

* Check if the Windows Package Manager is functional by running `winget` in PowerShell.

.Fixing `winget` if it doesn't work.
[%collapsible]
====
* For Windows 11, open the Microsoft Store, then update "App Installer" through it.

* For Windows 10 LTSC 2019 & 2021, run in Command Prompt as Administrator to install `winget`:
** `wsreset -i`
** If the Microsoft store doesn't show up after this command is complete, reboot.
** Open the Microsoft Store, then install "App Installer" through it.

====

. Download the https://github.com/felikcat/TuneUp11/releases[latest TuneUp11] and extract it.

. Do not disable your antivirus, as TuneUp11 should be compatible.

. Run `TuneUp11_Launcher.bat` as Administrator.

. Reboot after TuneUp11 is finished to see its changes fully in action.

== Extras
TIP: Login to the Microsoft Store before using `Install_Xbox_Minimal.bat`, otherwise it will not work. +
To also get the Game Bar, install the following link://www.microsoft.com/store/productId/9NZKPSTSNW4P[here] then link://www.microsoft.com/store/productId/9NBLGGH537C2[here].

* `Install_Xbox_Minimal.bat`
- Installs only what's required to support Xbox Controllers (GUI/interface not included, get it link://www.microsoft.com/store/productId/9NBLGGH30XJ3[here]), Microsoft's PC Game Pass, and specific games such as Forza Horizon 4 & 5.


* `Advanced.ps1`
** Contains a lot of extra features for those that know what they're doing.

** How to use:
. Configuration is required. +
-> Open `Advanced.ps1` in a text editor or IDE of your choosing.
. Run `Advanced.ps1` as Administrator.


== Recommendations

=== BIOS
* *Enable the following:*
. I/O APIC (IOAPIC 24-119 Entries)
. Above 4G Decoding and Resizable BAR.
** On ASRock motherboards: C.A.M. (Clever Access Memory)
** This is incompatible with Windows installed on an MBR partition; if Windows can no longer boot, this setting caused it.
. HPET (High Precision Event Timer)

* *Disable the following:*
. XHCI Hands Off
. USB Legacy
** link://techcommunity.microsoft.com/t5/microsoft-usb-blog/reasons-to-avoid-companion-controllers/ba-p/270710[Why disable these two?] +
Note: if a USB is no longer bootable after these two changes, temporarily turn them both back on.


=== Windows
. Remove every program you installed and work your way up to see what programs you really need.
- Use what Windows already includes instead of third-party programs. Keep it simple to reduce being impacted by https://www.bleepingcomputer.com/news/security/hackers-compromise-3cx-desktop-app-in-a-supply-chain-attack/[supply chain attacks] and to prevent causing Windows additional issues.

. Install all optional updates through Windows Update; it can include device drivers.

. Check if there's enterprise versions of manufacturer software, such as replacing Lenovo Vantage with Lenovo Commercial Vantage.


== Appendices

.Developer notes
[%collapsible]
====

* *Required software:*
. `winget install Microsoft.WindowsADK -eh`
. `scoop install git; scoop bucket add sysinternals; scoop install procmon`

* `Set-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Services\EXAMPLE" -Name "Start" -Type DWord -Value 4 -Force` is preferred over using `sc.exe config EXAMPLE start=disabled` since Windows rejects this request depending on the service.

* Non-volatile registry keys usually do not self-regenerate themselves if their key doesn't exist.
** If the purpose is to revert back to defaults, manually set the default value instead.

* The registry changes Group Policy edits do can be traced with link://docs.microsoft.com/en-us/sysinternals/downloads/procmon[Sysinternals Process Monitor].
** Filter to the process containing gpedit.msc: +
image:Procmon64_1.png[]
** Filter to registry changes only: +
image:Procmon64_2.png[]
*** Translate the traced registry edits to their non-group policy places, and there's your registry key edit.
**** Other processes of interest: +
`SystemPropertiesPerformance.exe`, `SystemSettings.exe`, `DllHost.exe` +
`SecurityHealthService.exe`

TIP: Example gpedit.msc registry translation: +
`HKCU\Software\Microsoft\Windows\CurrentVersion\Group Policy Objects\{2F5A9005-4CB6-4314-B846-8C3EB66C9C24}Machine\Software\Policies\Microsoft\Windows` *->* `HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent`

* Drivers currently loaded by Windows can be seen with link:https://systeminformer.sourceforge.io/downloads.php[System Informer] via:
. The "System" process -> Properties (right-click or press Enter with "System" selected) -> Modules

* List all from "Turn Windows features on or off" and their status:
. `(Get-WindowsOptionalFeature -Online -FeatureName '*') | Format-Table -Autosize`
- List all from "Settings > Apps > Optional features"/"Add an optional feature":
. `(Get-WindowsCapability -Online -Name '*') | Format-Table -Autosize`


* https://learn.microsoft.com/en-us/windows/package-manager/winget/install#options[`winget install` command line switches/options].
- https://learn.microsoft.com/en-us/windows/package-manager/winget/uninstall#options[The same but for `winget uninstall`].

* `-s winget` prevents Error 0x8a150044 if the Windows Store isn't currently reachable.

====

.Learning material used
[%collapsible]
====

. link://archive.org/details/windows-internals-part1-7th/mode/2up[Windows Internals, Part 1, 7th Edition]
** link://github.com/zodiacon/WindowsInternals[Windows Internals, Part 1, 7th Edition (unofficial) Tools]

. link://www.microsoftpressstore.com/store/windows-internals-part-2-9780135462409[Windows Internals, Part 2, 7th Edition]
** This can be viewed for free from the link://en.wikipedia.org/wiki/Z-Library[Z-Library].

. link://github.com/MicrosoftDocs/windows-driver-docs/tree/staging/windows-driver-docs-pr[Windows Driver Documentation]

. link://therealmjp.github.io/posts/breaking-down-barriers-part-1-whats-a-barrier/[TheRealMJP's blog posts on how GPU synchronization and preemption work]

. link:https://bromiley.medium.com/windows-wednesday-shim-cache-1997ba8b13e7[Matt B's blog post on Application Compatibility Cache]


'''

====
