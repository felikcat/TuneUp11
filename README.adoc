:experimental:
:imagesdir: Images/
ifdef::env-github[]
:icons:
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]

== About

* TuneUp11 compared to: O&O ShutUp10, W10Privacy, BloatyNosy, Wintoys, ChrisTitusTech's winutil, Pointstone AntiTrack, Debotnet, Debloat Windows 10, Atlas OS, Spybot Anti-Beacon, and Winrice.

- Easier to use.

- No programs or apps break after using TuneUp11.

- Doesn't reduce security.

- Fully open-source.

- Minimalist with clearly defined intentions inside the source files.

- Edits are done through the Group Policy Editor to block the reverting of TuneUp11 after any Windows Updates.

== The catches
. You have to do the following manually:
- Set a relevant compatibility mode for old programs requiring say, Windows XP mode.
- Clear thumbnail cache if it ever corrupts.

. Finding text inside files through Windows Search no longer works.

== Requirements
. Windows has to be activated; use a license key or run link://github.com/massgravel/Microsoft-Activation-Scripts[massgravel's MAS].

. Windows Package Manager is installed and functional.
- Test by opening PowerShell then run `winget`.

.Fixing `winget` if it doesn't work.
[%collapsible]
====
* For Windows 11, open the Microsoft Store, then update "App Installer" through it.

* For Windows 10 LTSC 2019 or 2022, run in Command Prompt as Administrator to install `winget`:
** `wsreset -i`
** If the Microsoft store doesn't show up after this command is complete, reboot.
** Open the Microsoft Store, then install "App Installer" through it.

====


== Instructions

. Download the link:https://github.com/felikcat/TuneUp11/releases[latest TuneUp11] and extract it.

. Run `Backup_Registry.bat` as Administrator a single time; only redo this after an update to a new major OS version (such as 21H2 -> 22H2).

. Disable your antivirus and third-party firewalls (Simplewall), save your files (TuneUp11 forces a restart), then run `TuneUp11.bat` as Administrator.
- What triggers an antivirus: TuneUp11 does a massive amount of registry edits in sensitive areas.


== Extras
. `W11_LTSC_2022.bat`
** Uninstalls a lot of default apps to replicate what Windows 10 LTSC 2022 includes by default.
*** Exceptions: App Installer, Store Experience Host, Windows Store, Windows Terminal, Xbox Game Speech Window.

.If `W11_LTSC_2022.bat` was used
[%collapsible]
====
. `Install_Xbox_Minimal.bat`
- *Login to the Microsoft Store before using this script, otherwise it will not work.*
- Installs only what's required to use Xbox Controllers (interface not included, get it link://www.microsoft.com/store/productId/9NBLGGH30XJ3[here]), Game Pass, and specific games like Forza Horizon 4 & 5.

** To also get the Game Bar, install the following link://www.microsoft.com/store/productId/9NZKPSTSNW4P[here] and link://www.microsoft.com/store/productId/9NBLGGH537C2[here].
====

. `Advanced.bat`
** Additional changes TuneUp11 can apply.
** Its settings can be changed in `Advanced.ps1`.


== Recommendations for advanced/power users

=== BIOS
* Enable the following
. I/O APIC (IOAPIC 24-119 Entries)
. Above 4G Decoding
. Resizable BAR
** This is incompatible with Windows installed on an MBR partition; if Windows can no longer boot, this setting caused it.
. HPET (High Precision Event Timer)

* Disable the following options in your motherboard's BIOS:
. XHCI Hands Off
. USB Legacy
** link://techcommunity.microsoft.com/t5/microsoft-usb-blog/reasons-to-avoid-companion-controllers/ba-p/270710[Why disable these two?] +
Note: if a USB is no longer bootable after these two changes, temporarily turn them both back on.


=== Windows

. Windows Settings -> Gaming -> Enable `Game Mode`
. Windows Settings -> Graphics -> Change default graphics settings -> Enable `Hardware-accelerated GPU scheduling`, and `Optimizations for windowed games`.

. Install all optional updates through Windows Update; it can include device drivers.

. Auto-detect and install link://www.amd.com/en/support[AMD drivers]. +
Auto-detect and install link://www.intel.com/content/www/us/en/support/detect.html[Intel's drivers].
* This will utilize their drivers instead of the generic drivers Microsoft provides, meaning better performance and lower DPC latency.


=== Replace problematic programs

This contains a long but important list. Be sure to check it if you're not sure.
[%collapsible]
====
. Use link:https://www.revouninstaller.com/products/revo-uninstaller-pro/[Revo Uninstaller] (moderate scan mode) to remove these programs that cause BSODs and anti-cheat problems, along with slower performance:
* ASUS Armoury Crate
* CORSAIR iCUE
* ASRock Polychrome RGB
* Gigabyte RGBFusion
* TT RGB Plus
* Razer Synapse
* Sapphire TriXX
* MSI Dragon Center
* HyperX NGENUITY
* Logitech G HUB
** Don't remove if using a Logitech steering wheel, it's required.
* NZXT CAM
* Any keyboard programs, such as Ducky RGB.

. Alternatives:
* link:https://openrgb.org/[OpenRGB] for RGB configuration.
* link:https://www.msi.com/Landing/afterburner/graphics-cards[MSI Afterburner] for general GPU management and overclocking.

====


== Appendices

.Developer notes
[%collapsible]
====

* Required software:
. `winget install Microsoft.WindowsADK -eh`
. `scoop install git; scoop bucket add sysinternals; scoop install procmon`

__

* `reg.exe add "HKLM\SYSTEM\CurrentControlSet\Services\EXAMPLE" /v "Start" /t REG_DWORD /d 4 /f` is preferred over using `sc.exe config EXAMPLE start=disabled` since Windows rejects this request depending on the service.

* MMCSS (Multimedia Class Scheduler) doesn't exist in Windows 10 LTSC 2022 and newer.

* Non-volatile registry keys usually do not self-regenerate themselves if their key doesn't exist.
** If the purpose is to revert back to defaults, manually set the default value instead.

* The registry changes Group Policy edits do can be traced with link://docs.microsoft.com/en-us/sysinternals/downloads/procmon[Sysinternals Process Monitor].
** Filter to the process containing gpedit.msc: +
image:Procmon64_1.png[]
** Filter to registry changes only: +
image:Procmon64_2.png[]
*** Translate the traced registry edits to their non-group policy places, and there's your registry key edit.
**** Other processes of interest: +
`SystemPropertiesPerformance.exe`, `SystemSettings.exe`, `DllHost.exe` +
`SecurityHealthService.exe`

TIP: Example gpedit.msc registry translation: +
`HKCU\Software\Microsoft\Windows\CurrentVersion\Group Policy Objects\{2F5A9005-4CB6-4314-B846-8C3EB66C9C24}Machine\Software\Policies\Microsoft\Windows` *->* `HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows\CloudContent`

* Drivers currently loaded by Windows can be seen with link:https://processhacker.sourceforge.io/nightly.php[Process Hacker] via:
. The "System" process -> Properties (right-click or press Enter with "System" selected) -> Modules

* List all from "Turn Windows features on or off" and their status:
. `(Get-WindowsOptionalFeature -Online -FeatureName '*') | Format-Table -Autosize`
- List all from "Settings > Apps > Optional features"/"Add an optional feature":
. `(Get-WindowsCapability -Online -Name '*') | Format-Table -Autosize`

====

.Learning material used
[%collapsible]
====

. link://archive.org/details/windows-internals-part1-7th/mode/2up[Windows Internals, Part 1, 7th Edition]
** link://github.com/zodiacon/WindowsInternals[Windows Internals, Part 1, 7th Edition (unofficial) Tools]

. link://www.microsoftpressstore.com/store/windows-internals-part-2-9780135462409[Windows Internals, Part 2, 7th Edition]
** This can be viewed for free from link://en.wikipedia.org/wiki/Z-Library[Z-Library].

. link://github.com/MicrosoftDocs/windows-driver-docs/tree/staging/windows-driver-docs-pr[Windows Driver Documentation]

. link://therealmjp.github.io/posts/breaking-down-barriers-part-1-whats-a-barrier/[TheRealMJP's blog posts on how GPU synchronization and preemption work]

. link:https://bromiley.medium.com/windows-wednesday-shim-cache-1997ba8b13e7[Matt B's blog post on Application Compatibility Cache]


---

* These projects helped TuneUp11 improve at a more rapid pace:
. https://github.com/Atlas-OS/Atlas
. https://github.com/beatcracker/toptout
. https://github.com/M2Team/NSudo
====
